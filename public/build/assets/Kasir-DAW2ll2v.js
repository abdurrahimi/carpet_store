import{A as rt}from"./AuthenticatedLayout-BU37uFwa.js";import{M as nt,a as lt}from"./vue-multiselect.esm-DYO3Cmdh.js";import{Z as it,z as ot,_ as dt,y as D,A as ct,o as d,c,a as S,t as p,d as b,b as t,F as I,B as U,e as u,v as _,n as et,x as at,C as ut,D as pt,l as mt}from"./app-TGxf9uSF.js";/* empty css                        */const _t={layout:rt,props:["data"],components:{Head:it,Modal:nt,Multiselect:lt},computed:{totalPrice(){var o,r;let s=0,a=0;(o=this.form.data)==null||o.map((h,j)=>{s+=parseInt(this.totalUnitPrice(j))??0}),(r=this.form.additional)==null||r.map((h,j)=>{let y=h.total.toString().replace(/\./g,"");a+=parseInt(y)});let m=this.form.discount??0;const g=parseInt(s)+parseInt(a)-parseInt(m.toString().replace(/\./g,""));return isNaN(g)?0:g}},data(){return{table:[{title:"Tanggal",data:"created_at"},{title:"Customer",data:"customer.name"},{title:"Jumlah",data:"final_price"}],modalTitle:"",modalShow:!1,selectedIds:[],form:{data:[{product:null,unit_top_price:0,qty:6,discount_price:0,discount_percentage:0,variants:[{panjang:6,jumlah:1}]}],customer:null,discount:0,discount_percentage:0,additional:[{name:"",total:0}],total:0,submit:!1},products:[],variant:null,store:[],preview:null,variants:[{panjang:0,jumlah:0}]}},mounted(){this.resetForm(),this.getProducts()},methods:{async submitForm(){try{return this.form.submit?void 0:(this.form.submit=!0,ot.post(this.route("order.create"),this.form,{preserveScroll:!0,onSuccess:()=>{this.form.submit=!1,$("#modal-add").modal("hide"),this.$success("Data berhasil disimpan"),ot.visit(this.$page.url,{only:["users"]})},onError:()=>{this.form.submit=!1,this.$error()}}))}catch{this.form.submit=!1}},totalPriceBeforeDisc(){var m,g;let s=0,a=0;return(m=this.form.data)==null||m.map((o,r)=>{s+=parseInt(this.totalUnitPrice(r))??0}),(g=this.form.additional)==null||g.map((o,r)=>{let h=o.total.toString().replace(/\./g,"");a+=parseInt(h)}),console.log(s),parseInt(s)+parseInt(a)},totalUnitPrice(s){let a=this.form.data[s].unit_price||0,m=this.form.data[s].discount_price||0,g=parseInt(a.toString().replace(/\./g,""))||0,o=parseInt(this.form.data[s].qty)||0,r=parseInt(m.toString().replace(/\./g,""))||0,h=g*o/6-r;return isNaN(h)?0:h},calcDisPrice(s){if(this.form.data[s].discount_percentage==""||this.form.data[s].discount_percentage==null){this.form.data[s].discount_percentage=0;return}let a=this.form.data[s].unit_price.toString().replace(/\./g,"");this.form.data[s].discount_price=this.form.data[s].discount_percentage/100*(parseInt(a)*this.form.data[s].qty/6)},calcDisPerc(s){let a=this.form.data[s].discount_price.toString().replace(/\./g,""),m=this.form.data[s].unit_price.toString().replace(/\./g,"");this.form.data[s].discount_percentage=parseInt(a)/(parseInt(m)*this.form.data[s].qty/6)*100,this.form.data[s].discount_percentage=this.form.data[s].discount_percentage.toFixed(2)},calcTotalDisPrice(){if(this.form.discount_percentage==""||this.form.discount_percentage==null){this.form.discount_percentage=0;return}let s=this.totalPriceBeforeDisc();console.log(s),this.form.discount=this.form.discount_percentage/100*parseInt(s.toString().replace(/\./g,""))},calcTotalDisPerc(){let s=this.form.discount.toString().replace(/\./g,""),a=this.totalPriceBeforeDisc();this.form.discount_percentage=(parseInt(s)/parseInt(a.toString().replace(/\./g,""))*100).toFixed(2)},formatMoney(s){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(s)},tambahVariants(s){this.form.data[s].product&&this.form.data[s].variants.push({panjang:6,jumlah:1})},removeVariant(s,a){this.form.data[s].variants.splice(a,1)},calculateAll(s){this.calcDisPrice(s)},async getProducts(s=""){try{const{data:a}=await axios.get(this.route("products.get",{name:s}));this.products=a}catch(a){console.error("Error loading products",a)}},resetForm(){this.form={data:[{product:null,unit_top_price:0,qty:6,discount_price:0,discount_percentage:0,variants:[{panjang:6,jumlah:1}]}],customer:null,discount:0,discount_percentage:0,additional:[{name:"",total:0}],total:0,submit:!1}},resetFormByKey(s){this.form.data[s]={product:null,unit_top_price:0,qty:6,discount_price:0,discount_percentage:0,variants:[{panjang:6,jumlah:1}]}},tambahProduct(){this.form.data.push({product:null,qty:6,unit_top_price:0,discount_price:0,discount_percentage:0,variants:[{panjang:6,jumlah:1}]})},tambahFee(){this.form.additional.push({name:"",total:0})},removeAdditional(s){s!=0&&this.form.additional.splice(s,1)},removeProduct(s){s!=0&&this.form.data.splice(s,1)},addCustomer(){console.log("okok")},pilihData(s){const a=this.form.data[s].product;this.form.data[s].unit_price=a.lowest_price??0,this.form.data[s].image=a.image}}},n=s=>(ut("data-v-be0040d9"),s=s(),pt(),s),ht={key:0,class:"alert alert-success",role:"alert"},ft={key:1,class:"alert alert-danger",role:"alert"},gt={class:"card shadow mb-5"},bt={class:"card-body"},vt={id:"form-kasir"},Pt={class:"table"},xt=n(()=>t("thead",null,null,-1)),Vt={rowspan:"3"},jt=["src"],wt={class:"nt",style:{width:"25%"}},It={class:"form-group"},yt=n(()=>t("label",{for:"product_id",class:"form-label"},"Produk",-1)),Dt={class:"text-danger"},St={class:"nt",style:{width:"15%"}},Ut={class:"form-group"},Ct=n(()=>t("label",{for:"jumlah",class:"form-label"},"Jumlah (Meter)",-1)),Ft={class:"input-group"},Tt=["disabled","onKeyup","onUpdate:modelValue"],Kt=n(()=>t("div",{class:"input-group-append"},[t("span",{class:"input-group-text"},"Meter")],-1)),qt={class:"text-danger"},Mt={class:"nt",style:{width:"30%"}},Rt={class:"form-group"},At=n(()=>t("label",{for:"jumlah",class:"form-label"},"Unit Price",-1)),Bt={key:0},Nt={class:"input-group"},zt=n(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),Ht=["onKeyup","disabled","onUpdate:modelValue"],Et={class:"text-danger"},Jt={class:"nt align-middle",rowspan:"3"},Lt=["onClick"],Ot={class:"nt",colspan:"3"},Zt={class:"col-md-12 row"},Gt=n(()=>t("label",{for:"jumlah",class:"form-label"},"Variants",-1)),Qt=["onClick"],Wt=n(()=>t("span",{style:{"font-size":"10px"}},"+",-1)),Xt=[Wt],Yt={class:"col-md-12"},kt={class:"row"},$t={class:"col-md-3 shadow mr-2 p-3 rounded-lg",style:{border:`1px solid
                                                                #f0f0f0`}},ts=["onClick"],ss={class:"row"},os={class:"col-md-6",style:{padding:"0px"}},es={class:"form-group"},as=n(()=>t("label",{for:"jumlah",class:"form-label",style:{"font-size":"12px"}},"Panjang",-1)),rs={class:"input-group"},ns=["onUpdate:modelValue","disabled"],ls={class:"col-md-6",style:{}},is={class:"form-group"},ds=n(()=>t("label",{for:"jumlah",class:"form-label",style:{"font-size":"12px"}},"Jumlah",-1)),cs={class:"input-group"},us=["onUpdate:modelValue","disabled"],ps={class:"nt"},ms={class:"form-group"},_s=n(()=>t("label",{for:"jumlah",class:"form-label"},"Discount (%)",-1)),hs={class:"input-group"},fs=["onKeyup","disabled","onUpdate:modelValue"],gs=n(()=>t("div",{class:"input-group-append"},[t("span",{class:"input-group-text"},"%")],-1)),bs={class:"text-danger"},vs={class:"nt"},Ps={class:"form-group"},xs=n(()=>t("label",{for:"jumlah",class:"form-label"},"Discount (Rp)",-1)),Vs={class:"input-group"},js=n(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),ws=["onKeyup","disabled","onUpdate:modelValue"],Is={class:"text-danger"},ys={class:"nt"},Ds={class:"form-group"},Ss=n(()=>t("label",{for:"jumlah",class:"form-label"},"Total Price",-1)),Us={class:"input-group"},Cs=n(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),Fs=["value"],Ts={class:"text-danger"},Ks=["rowspan"],qs=n(()=>t("label",null,"Additional Fee",-1)),Ms=[qs],Rs={colspan:"2"},As={class:"form-group"},Bs={for:"additional_fee",class:"form-label"},Ns=["onUpdate:modelValue","disabled"],zs={class:"form-group"},Hs=n(()=>t("label",{for:"additional_fee",class:"form-label"},"Harga",-1)),Es={class:"input-group"},Js=n(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),Ls=["onUpdate:modelValue","disabled"],Os={class:"nt align-middle"},Zs=["onClick"],Gs=n(()=>t("td",{colspan:"2"},"Discount",-1)),Qs={class:"form-group"},Ws={class:"input-group"},Xs=["disabled"],Ys=n(()=>t("div",{class:"input-group-append"},[t("span",{class:"input-group-text"},"%")],-1)),ks={class:"form-group"},$s={class:"input-group"},to=n(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),so=["disabled"],oo=n(()=>t("td",null,null,-1)),eo=n(()=>t("td",{colspan:"3"},"Total Transaksi",-1)),ao={class:"form-group"},ro={class:"input-group"},no=n(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),lo=["value"],io=n(()=>t("td",null,null,-1)),co=n(()=>t("td",{colspan:"3"},"Kasir",-1)),uo={class:"form-group"},po=n(()=>t("td",null,null,-1)),mo={class:"card shadow"},_o=n(()=>t("div",{class:"card-header"},[t("h4",{class:"card-title"},[t("i",{class:"fa fa-box"}),at(" Data Penjualan Hari Ini ")])],-1));function ho(s,a,m,g,o,r){var C,F;const h=D("Head"),j=D("Multiselect"),y=D("Table"),v=ct("money");return d(),c("div",null,[S(h,{title:"Kasir"}),s.$page.props.flash.success?(d(),c("div",ht,p(s.$page.props.flash.success),1)):b("",!0),s.$page.props.flash.error?(d(),c("div",ft,p(s.$page.props.flash.error),1)):b("",!0),t("div",gt,[t("div",bt,[t("form",vt,[t("button",{class:"btn btn-primary btn-sm mb-2 float-right",type:"button",onClick:a[0]||(a[0]=(...i)=>r.tambahProduct&&r.tambahProduct(...i))}," + Tambah Product "),t("table",Pt,[xt,t("tbody",null,[(d(!0),c(I,null,U(o.form.data,(i,e)=>{var x,V,f,T,K,q,M,R,A,B,N,z,H,E,J,L,O,Z,G,Q,W,X,Y,k,tt,st;return d(),c(I,null,[t("tr",null,[t("td",Vt,[t("img",{src:i.image??"https://img.freepik.com/premium-vector/default-image-icon-vector-missing-picture-page-website-design-mobile-app-no-photo-available_87543-11093.jpg",alt:"Image Preview",class:"img-fluid",style:{"max-width":"300px"}},null,8,jt)]),t("td",wt,[t("div",It,[yt,S(j,{modelValue:o.form.data[e].product,"onUpdate:modelValue":l=>o.form.data[e].product=l,options:o.products,"track-by":"id",placeholder:"Pilih Produk",label:"design_name",onSearchChange:r.getProducts,onSelect:l=>r.pilihData(e),onRemove:l=>r.resetFormByKey(e),"internal-search":!1,class:et({"is-invalid":(T=(f=(V=(x=s.$page)==null?void 0:x.props)==null?void 0:V.errors)==null?void 0:f.product)==null?void 0:T.id})},null,8,["modelValue","onUpdate:modelValue","options","onSearchChange","onSelect","onRemove","class"]),t("span",Dt,p((R=(M=(q=(K=s.$page)==null?void 0:K.props)==null?void 0:q.errors)==null?void 0:M.product)==null?void 0:R.id),1)])]),t("td",St,[t("div",Ut,[Ct,t("div",Ft,[u(t("input",{type:"number",class:"form-control",disabled:!o.form.data[e].product,min:"0",onKeyup:l=>o.form.data[e].qty=o.form.data[e].qty===""||o.form.data[e].qty===null?0:o.form.data[e].qty,"onUpdate:modelValue":l=>o.form.data[e].qty=l},null,40,Tt),[[_,o.form.data[e].qty]]),Kt]),t("span",qt,p((z=(N=(B=(A=s.$page)==null?void 0:A.props)==null?void 0:B.errors)==null?void 0:N.product)==null?void 0:z.id),1)])]),t("td",Mt,[t("div",Rt,[At,o.form.data[e].product?(d(),c("span",Bt," ("+p(r.formatMoney(o.form.data[e].product.lowest_price))+" - "+p(r.formatMoney(o.form.data[e].product.lowest_price))+")",1)):b("",!0),t("div",Nt,[zt,u(t("input",{type:"text",class:"form-control",onKeyup:l=>r.calcDisPrice(e),disabled:!o.form.data[e].product,"onUpdate:modelValue":l=>o.form.data[e].unit_price=l},null,40,Ht),[[v],[_,o.form.data[e].unit_price]])]),t("span",Et,p((L=(J=(E=(H=s.$page)==null?void 0:H.props)==null?void 0:E.errors)==null?void 0:J.product)==null?void 0:L.id),1)])]),t("td",Jt,[u(t("a",{class:"btn btn-danger btn-sm",onClick:l=>r.removeProduct(e)},"x",8,Lt),[[mt,e!=0]])])]),t("tr",null,[t("td",Ot,[t("div",Zt,[Gt,at("   "),t("button",{class:"btn btn-primary btn-sm",type:"button",onClick:l=>r.tambahVariants(e)},Xt,8,Qt),t("div",Yt,[t("div",kt,[(d(!0),c(I,null,U(o.form.data[e].variants,(l,P)=>(d(),c("div",$t,[P!==0?(d(),c("a",{key:0,class:"btn btn-danger btn-sm",onClick:w=>r.removeVariant(e,P),style:{position:"absolute",right:"-6px",top:"-6px"}},"x",8,ts)):b("",!0),t("div",ss,[t("div",os,[t("div",es,[as,t("div",rs,[u(t("input",{"onUpdate:modelValue":w=>o.form.data[e].variants[P].panjang=w,type:"number",disabled:!o.form.data[e].product,class:"form-control",min:"0"},null,8,ns),[[_,o.form.data[e].variants[P].panjang]])])])]),t("div",ls,[t("div",is,[ds,t("div",cs,[u(t("input",{type:"number","onUpdate:modelValue":w=>o.form.data[e].variants[P].jumlah=w,class:"form-control",disabled:!o.form.data[e].product,min:"0"},null,8,us),[[_,o.form.data[e].variants[P].jumlah]])])])])])]))),256))])])])])]),t("tr",null,[t("td",ps,[t("div",ms,[_s,t("div",hs,[u(t("input",{type:"number",class:"form-control",onKeyup:l=>r.calculateAll(e),disabled:!o.form.data[e].product,"onUpdate:modelValue":l=>o.form.data[e].discount_percentage=l},null,40,fs),[[_,o.form.data[e].discount_percentage]]),gs]),t("span",bs,p((G=(Z=(O=s.$page)==null?void 0:O.props)==null?void 0:Z.errors)==null?void 0:G.discount_percentage),1)])]),t("td",vs,[t("div",Ps,[xs,t("div",Vs,[js,u(t("input",{type:"text",class:"form-control",onKeyup:l=>r.calcDisPerc(e),disabled:!o.form.data[e].product,"onUpdate:modelValue":l=>o.form.data[e].discount_price=l},null,40,ws),[[v],[_,o.form.data[e].discount_price]])]),t("span",Is,p((X=(W=(Q=s.$page)==null?void 0:Q.props)==null?void 0:W.errors)==null?void 0:X.discount_price),1)])]),t("td",ys,[t("div",Ds,[Ss,t("div",Us,[Cs,u(t("input",{type:"text",class:"form-control",value:r.totalUnitPrice(e),disabled:""},null,8,Fs),[[v]])]),t("span",Ts,p((st=(tt=(k=(Y=s.$page)==null?void 0:Y.props)==null?void 0:k.errors)==null?void 0:tt.product)==null?void 0:st.id),1)])])])],64)}),256)),(d(!0),c(I,null,U(o.form.additional,(i,e)=>{var x,V;return d(),c("tr",{key:e},[e==0?(d(),c("td",{key:0,rowspan:Object.keys(o.form.additional).length,class:"align-middle"},Ms,8,Ks)):b("",!0),t("td",Rs,[t("div",As,[t("label",Bs," Additional Service "+p(e+1),1),u(t("input",{type:"text",class:"form-control","onUpdate:modelValue":f=>o.form.additional[e].name=f,disabled:!((x=o.form.data[0])!=null&&x.product)},null,8,Ns),[[_,o.form.additional[e].name]])])]),t("td",null,[t("div",zs,[Hs,t("div",Es,[Js,u(t("input",{class:"form-control",type:"text","onUpdate:modelValue":f=>o.form.additional[e].total=f,disabled:!((V=o.form.data[0])!=null&&V.product),min:"0"},null,8,Ls),[[v],[_,o.form.additional[e].total]])])])]),t("td",Os,[e!=0?(d(),c("button",{key:0,class:"btn btn-danger btn-sm",onClick:f=>r.removeAdditional(e)}," x ",8,Zs)):b("",!0),e==0?(d(),c("button",{key:1,class:"btn btn-primary btn-sm",type:"button",onClick:a[1]||(a[1]=(...f)=>r.tambahFee&&r.tambahFee(...f))}," + ")):b("",!0)])])}),128)),t("tr",null,[Gs,t("td",null,[t("div",Qs,[t("div",Ws,[u(t("input",{"onUpdate:modelValue":a[2]||(a[2]=i=>o.form.discount_percentage=i),class:"form-control",type:"number",onKeyup:a[3]||(a[3]=(...i)=>r.calcTotalDisPrice&&r.calcTotalDisPrice(...i)),disabled:!((C=o.form.data[0])!=null&&C.product)},null,40,Xs),[[_,o.form.discount_percentage]]),Ys])])]),t("td",null,[t("div",ks,[t("div",$s,[to,u(t("input",{"onUpdate:modelValue":a[4]||(a[4]=i=>o.form.discount=i),class:"form-control",type:"text",disabled:!((F=o.form.data[0])!=null&&F.product),onKeyup:a[5]||(a[5]=(...i)=>r.calcTotalDisPerc&&r.calcTotalDisPerc(...i))},null,40,so),[[v],[_,o.form.discount]])])])]),oo]),t("tr",null,[eo,t("td",null,[t("div",ao,[t("div",ro,[no,u(t("input",{class:"form-control",type:"text",value:r.totalPrice,disabled:""},null,8,lo),[[v]])])])]),io]),t("tr",null,[co,t("td",null,[t("div",uo,[t("a",{class:et(["btn btn-primary float-right",{disabled:o.form.submit}]),onClick:a[6]||(a[6]=(...i)=>r.submitForm&&r.submitForm(...i))},"Submit",2)])]),po])])])])])]),t("div",mo,[_o,S(y,{columns:o.table,rows:m.data},null,8,["columns","rows"])])])}const Po=dt(_t,[["render",ho],["__scopeId","data-v-be0040d9"]]);export{Po as default};
