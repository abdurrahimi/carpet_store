import{A as ve}from"./AuthenticatedLayout-BpgTmOaQ.js";import{M as ye,a as Se}from"./vue-multiselect-Ct0g21Ay.js";import{Z as we,a as r,x as l,D as m,_ as De,y as f,o as d,c as p,b as s,m as b,p as Ve,t as c,d as h,n as u,e as k,v as be,G as Ce,w as Te}from"./app-XKJXP1mp.js";const Me={layout:ve,props:["stock"],components:{Head:we,Modal:ye,Multiselect:Se},data(){return{table:[{title:"Nama Produk",data:"product.name"},{title:"Jumlah",data:"total"},{title:"Tipe",data:"stock_type",render:e=>e.stock_type==1?r("span",{class:"badge badge-success"},[l("Baru")]):r("span",{class:"badge badge-warning"},[l("Bekas")])},{title:"Tipe Stok",data:"type",render:e=>e.type=="IN"?r("span",{class:"text-success"},[l("Stock In")]):r("span",{class:"text-danger"},[l("Stock In")])},{title:"Toko",data:"store.name"},{title:"Supplier",data:"supplier.name"},{title:"Status",data:"approval.status",render:e=>{switch(e.status){case 0:return r("span",{class:"badge badge-warning"},[l("Pending")]);case 1:return r("span",{class:"badge badge-primary"},[l("Disetujui")]);case 2:return r("span",{class:"badge badge-danger"},[l("Ditolak")]);default:return r("span",{class:"badge badge-warning"},[l("Pending")])}}}],modalTitle:"",modalShow:!1,selectedIds:[],form:{},data:this.stock,products:[],store:[],supplier:[{id:2,name:"xx"}]}},mounted(){this.resetForm(),this.getProducts(),this.getDataStore(),this.getDataSupplier()},methods:{createStock(){this.$page.props.errors=null,this.resetForm(),this.modalTitle="Tambah Data Stok",$("#modal-stock-index").modal("show")},deleteRow(e){this.$confirm("Data yang sudah dihapus tidak dapat dikembalikan!",()=>this.deleteAction(e),!1)},deleteAction(e){m.delete(this.route("stock.delete",e.id),{preserveScroll:!0,onSuccess:()=>{this.$success("Data berhasil dihapus"),m.visit(this.$page.url,{only:["stock"]})},onError:()=>{this.$error()}})},handleSelectedRows(e){this.selectedIds=e},async submitForm(){try{return this.form.submit?void 0:(this.form.submit=!0,this.form.id==""||this.form.id==null?m.post(this.route("stock.store"),this.form,{preserveScroll:!0,onSuccess:()=>{this.$success("Data berhasil disimpan"),m.visit(this.$page.url,{only:["stock"]}),this.form.submit=!1,$("#modal-stock-index").modal("hide")},onError:()=>{this.form.submit=!1,this.$error()}}):m.put(this.route("stock.update",this.form.id),this.form,{preserveScroll:!0,onSuccess:()=>{this.$success("Data berhasil disimpan"),m.visit(this.$page.url,{only:["stock"]}),this.form.submit=!1,$("#modal-stock-index").modal("hide")},onError:()=>{this.form.submit=!1,this.$error()}}))}catch{this.form.submit=!1,this.$error("Terjadi kesalahan saat menyimpan data")}},resetForm(){this.form={id:null,product:null,stock_type:1,value:"",product_type:1,stock_ref:"",submit:!1}},populateForm(e){this.form.id=e.id,this.form.product=e.product,this.form.product_type=e.stock_type,this.form.total=e.total,this.form.store=e.store,this.form.supplier=e.supplier,this.form.store=e.store},async getProducts(e=""){try{const{data:t}=await axios.get(this.route("products.get",{search:e}));this.products=t}catch(t){console.error("Error loading products",t)}},async getDataStore(e=""){let{data:t}=await axios.get(this.route("store.get",{name:e}));this.store=t},async getDataSupplier(e=""){}}},Pe={class:"text-right"},je=s("i",{class:"fa fa-trash"},null,-1),Be={key:0,class:"alert alert-success",role:"alert"},Fe={key:1,class:"alert alert-danger",role:"alert"},Ue={class:"card shadow"},Ie=s("div",{class:"card-header"},[s("h4",{class:"card-title"},[s("i",{class:"fa fa-box"}),l(" Data Stok ")])],-1),$e=["onClick"],Ne={class:"row"},Re={class:"col-md-6 mb-3"},Ee=s("label",{for:"product_id",class:"form-label"},"Pilih Produk",-1),Ae={class:"text-danger"},He={class:"col-md-6 mb-3"},qe=s("label",{for:"toko_id",class:"form-label"},"Store",-1),Je={class:"text-danger"},Le={class:"col-md-6 mb-3"},ze=s("label",{for:"toko_id",class:"form-label"},"Supplier",-1),Ge={class:"text-danger"},Ze={class:"col-md-6 mb-3"},xe={class:"form-group"},Ke=s("label",{for:"total"},"Jumlah",-1),Oe={key:0,class:"invalid-feedback"},Qe={class:"col-md-6 mb-3"},We={class:"form-group"},Xe=s("label",{for:"product_type"},"Tipe Produk",-1),Ye=s("option",{value:"1"},"Baru",-1),es=s("option",{value:"2"},"Bekas",-1),ss=[Ye,es],ts={key:0,class:"invalid-feedback"},os={key:0,class:"col-md-6 mb-3"},rs={class:"form-group"},as=s("label",{for:"value"},"Sisa Panjang(Meter)",-1),ls={key:0,class:"invalid-feedback"},is={key:0},ns=s("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1),ds=s("span",{class:"bott"},"Loading",-1),ps=[ns,ds],cs={key:1,class:"bott"};function us(e,t,ms,hs,o,n){const ge=f("Head"),_e=f("Table"),g=f("Multiselect"),ke=f("Modal");return d(),p("div",null,[r(ge,{title:"Data Stok"}),s("div",Pe,[r(Ve,{name:"fade"},{default:b(()=>[s("button",{class:u([o.selectedIds.length>0?"show":"","btn btn-danger mr-2 mb-2 fade"]),onClick:t[0]||(t[0]=(...i)=>e.deleteSelected&&e.deleteSelected(...i))},[je,l(" Hapus Pilihan ")],2)]),_:1}),s("button",{class:"btn btn-primary mb-2",type:"button",onClick:t[1]||(t[1]=(...i)=>n.createStock&&n.createStock(...i))}," + Stok Baru ")]),e.$page.props.flash.success?(d(),p("div",Be,c(e.$page.props.flash.success),1)):h("",!0),e.$page.props.flash.error?(d(),p("div",Fe,c(e.$page.props.flash.error),1)):h("",!0),s("div",Ue,[Ie,r(_e,{columns:o.table,rows:o.data,"onUpdate:selectedRows":n.handleSelectedRows},{actions:b(({row:i})=>[s("button",{onClick:_=>n.deleteRow(i),class:"btn btn-danger btn-sm",title:"Delete"}," Delete",8,$e),l("  ")]),_:1},8,["columns","rows","onUpdate:selectedRows"])]),r(ke,{show:o.modalShow,title:o.modalTitle,id:"modal-stock-index"},{footer:b(()=>[s("button",{type:"button",class:u(["btn btn-primary",{disabled:o.form.submit}]),onClick:t[9]||(t[9]=(...i)=>n.submitForm&&n.submitForm(...i))},[o.form.submit?(d(),p("div",is,ps)):(d(),p("span",cs,"Simpan"))],2)]),default:b(()=>{var i,_,v,y,S,w,D,V,C,T,M,P,j,B,F,U,I,N,R,E,A,H,q,J,L,z,G,Z,x,K,O,Q,W,X,Y,ee,se,te,oe,re,ae,le,ie,ne,de,pe,ce,ue,me,he,fe;return[s("form",{ref:"formStock",onSubmit:t[8]||(t[8]=Te((...a)=>e.handleSubmit&&e.handleSubmit(...a),["prevent"]))},[s("div",Ne,[s("div",Re,[Ee,r(g,{modelValue:o.form.product,"onUpdate:modelValue":t[2]||(t[2]=a=>o.form.product=a),options:o.products,"track-by":"id",label:"name",onSearchChange:n.getProducts,"internal-search":!1,class:u({"is-invalid":(y=(v=(_=(i=e.$page)==null?void 0:i.props)==null?void 0:_.errors)==null?void 0:v.product)==null?void 0:y.id})},null,8,["modelValue","options","onSearchChange","class"]),s("span",Ae,c((V=(D=(w=(S=e.$page)==null?void 0:S.props)==null?void 0:w.errors)==null?void 0:D.product)==null?void 0:V.id),1)]),s("div",He,[qe,r(g,{modelValue:o.form.store,"onUpdate:modelValue":t[3]||(t[3]=a=>o.form.store=a),options:o.store,"track-by":"id",label:"name",onSearchChange:n.getDataStore,"internal-search":!1,class:u({"is-invalid":(P=(M=(T=(C=e.$page)==null?void 0:C.props)==null?void 0:T.errors)==null?void 0:M.store)==null?void 0:P.id})},null,8,["modelValue","options","onSearchChange","class"]),s("span",Je,c((U=(F=(B=(j=e.$page)==null?void 0:j.props)==null?void 0:B.errors)==null?void 0:F.store)==null?void 0:U.id),1)]),s("div",Le,[ze,r(g,{modelValue:o.form.supplier,"onUpdate:modelValue":t[4]||(t[4]=a=>o.form.supplier=a),options:o.supplier,"track-by":"id",label:"name",onSearchChange:n.getDataSupplier,"internal-search":!1,class:u({"is-invalid":(E=(R=(N=(I=e.$page)==null?void 0:I.props)==null?void 0:N.errors)==null?void 0:R.supplier)==null?void 0:E.id})},null,8,["modelValue","options","onSearchChange","class"]),s("span",Ge,c((J=(q=(H=(A=e.$page)==null?void 0:A.props)==null?void 0:H.errors)==null?void 0:q.supplier)==null?void 0:J.id),1)]),s("div",Ze,[s("div",xe,[Ke,k(s("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=a=>o.form.total=a),class:u(["form-control",{"is-invalid":(G=(z=(L=e.$page)==null?void 0:L.props)==null?void 0:z.errors)==null?void 0:G.total}]),id:"total",required:""},null,2),[[be,o.form.total]]),(K=(x=(Z=e.$page)==null?void 0:Z.props)==null?void 0:x.errors)!=null&&K.total?(d(),p("div",Oe,c((W=(Q=(O=e.$page)==null?void 0:O.props)==null?void 0:Q.errors)==null?void 0:W.total),1)):h("",!0)])]),s("div",Qe,[s("div",We,[Xe,k(s("select",{"onUpdate:modelValue":t[6]||(t[6]=a=>o.form.product_type=a),class:u(["form-control",{"is-invalid":(ee=(Y=(X=e.$page)==null?void 0:X.props)==null?void 0:Y.errors)==null?void 0:ee.product_type}]),id:"product_type"},ss,2),[[Ce,o.form.product_type]]),(oe=(te=(se=e.$page)==null?void 0:se.props)==null?void 0:te.errors)!=null&&oe.product_type?(d(),p("div",ts,c((le=(ae=(re=e.$page)==null?void 0:re.props)==null?void 0:ae.errors)==null?void 0:le.product_type),1)):h("",!0)])]),o.form.product_type==2?(d(),p("div",os,[s("div",rs,[as,k(s("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=a=>o.form.panjang=a),class:u(["form-control",{"is-invalid":(de=(ne=(ie=e.$page)==null?void 0:ie.props)==null?void 0:ne.errors)==null?void 0:de.panjang}]),id:"value",required:""},null,2),[[be,o.form.panjang]]),(ue=(ce=(pe=e.$page)==null?void 0:pe.props)==null?void 0:ce.errors)!=null&&ue.panjang?(d(),p("div",ls,c((fe=(he=(me=e.$page)==null?void 0:me.props)==null?void 0:he.errors)==null?void 0:fe.panjang),1)):h("",!0)])])):h("",!0)])],544)]}),_:1},8,["show","title"])])}const _s=De(Me,[["render",us]]);export{_s as default};
