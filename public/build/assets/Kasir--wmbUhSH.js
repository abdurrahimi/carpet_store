import{A as at}from"./AuthenticatedLayout-Cj-jz2_Y.js";import{M as rt,a as lt}from"./vue-multiselect.esm-BsSAitZB.js";import{Z as it,h as et,_ as nt,r as w,E as dt,o as d,c,a as C,t as _,d as v,b as t,n as S,F as U,l as y,e as m,v as g,p as ct,m as ut,g as pt}from"./app-BSxKCNTV.js";/* empty css                        */const mt={layout:at,props:["data"],components:{Head:it,Modal:rt,Multiselect:lt},computed:{totalPrice(){var o,r;let s=0,e=0;(o=this.form.data)==null||o.map((h,P)=>{s+=parseInt(this.totalUnitPrice(P))??0}),(r=this.form.additional)==null||r.map((h,P)=>{let D=h.total.toString().replace(/\./g,"");e+=parseInt(D)});let u=this.form.discount??0;const p=parseInt(s)+parseInt(e)-parseInt(u.toString().replace(/\./g,""));return isNaN(p)?0:p}},data(){return{table:[{title:"Tanggal",data:"created_at"},{title:"Customer",data:"customer.name"},{title:"Jumlah",data:"final_price"}],modalTitle:"",modalShow:!1,selectedIds:[],form:{data:[{product:null,unit_top_price:0,qty:6,discount_price:0,discount_percentage:0,variants:[{panjang:6,jumlah:1}]}],customer:null,discount:0,discount_percentage:0,additional:[{name:"",total:0}],total:0,submit:!1},products:[],variant:null,customer:[],store:[],preview:null,variants:[{panjang:0,jumlah:0}]}},mounted(){this.resetForm(),this.getProducts(),this.getCustomers()},methods:{async submitForm(){try{return this.form.submit?void 0:(this.form.submit=!0,et.post(this.route("order.create"),this.form,{preserveScroll:!0,onSuccess:()=>{this.form.submit=!1,$("#modal-add").modal("hide"),this.$success("Data berhasil disimpan"),et.visit(this.$page.url,{only:["users"]})},onError:()=>{this.form.submit=!1,this.$error()}}))}catch{this.form.submit=!1}},totalPriceBeforeDisc(){var u,p;let s=0,e=0;return(u=this.form.data)==null||u.map((o,r)=>{s+=parseInt(this.totalUnitPrice(r))??0}),(p=this.form.additional)==null||p.map((o,r)=>{let h=o.total.toString().replace(/\./g,"");e+=parseInt(h)}),console.log(s),parseInt(s)+parseInt(e)},totalUnitPrice(s){let e=this.form.data[s].unit_price||0,u=this.form.data[s].discount_price||0,p=parseInt(e.toString().replace(/\./g,""))||0,o=parseInt(this.form.data[s].qty)||0,r=parseInt(u.toString().replace(/\./g,""))||0,h=p*o/6-r;return isNaN(h)?0:h},calcDisPrice(s){if(this.form.data[s].discount_percentage==""||this.form.data[s].discount_percentage==null){this.form.data[s].discount_percentage=0;return}let e=this.form.data[s].unit_price.toString().replace(/\./g,"");this.form.data[s].discount_price=this.form.data[s].discount_percentage/100*(parseInt(e)*this.form.data[s].qty/6)},calcDisPerc(s){let e=this.form.data[s].discount_price.toString().replace(/\./g,""),u=this.form.data[s].unit_price.toString().replace(/\./g,"");this.form.data[s].discount_percentage=parseInt(e)/(parseInt(u)*this.form.data[s].qty/6)*100,this.form.data[s].discount_percentage=this.form.data[s].discount_percentage.toFixed(2)},calcTotalDisPrice(){if(this.form.discount_percentage==""||this.form.discount_percentage==null){this.form.discount_percentage=0;return}let s=this.totalPriceBeforeDisc();console.log(s),this.form.discount=this.form.discount_percentage/100*parseInt(s.toString().replace(/\./g,""))},calcTotalDisPerc(){let s=this.form.discount.toString().replace(/\./g,""),e=this.totalPriceBeforeDisc();this.form.discount_percentage=(parseInt(s)/parseInt(e.toString().replace(/\./g,""))*100).toFixed(2)},formatMoney(s){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(s)},tambahVariants(s){this.form.data[s].product&&this.form.data[s].variants.push({panjang:6,jumlah:1})},removeVariant(s,e){e!=0&&this.form.data[s].variants.splice(e,1)},calculateAll(s){this.calcDisPrice(s)},async getProducts(s=""){try{const{data:e}=await axios.get(this.route("products.get",{name:s}));this.products=e}catch(e){console.error("Error loading products",e)}},resetForm(){this.form={data:[{product:null,unit_top_price:0,qty:6,discount_price:0,discount_percentage:0,variants:[{panjang:6,jumlah:1}]}],customer:null,discount:0,discount_percentage:0,additional:[{name:"",total:0}],total:0,submit:!1}},resetFormByKey(s){this.form.data[s]={product:null,unit_top_price:0,qty:6,discount_price:0,discount_percentage:0,variants:[{panjang:6,jumlah:1}]}},tambahProduct(){this.form.data.push({product:null,qty:6,unit_top_price:0,discount_price:0,discount_percentage:0,variants:[{panjang:6,jumlah:1}]})},tambahFee(){this.form.additional.push({name:"",total:0})},removeAdditional(s){s!=0&&this.form.additional.splice(s,1)},removeProduct(s){s!=0&&this.form.data.splice(s,1)},addCustomer(){console.log("okok")},pilihData(s){const e=this.form.data[s].product;this.form.data[s].unit_price=e.lowest_price??0,this.form.data[s].image=e.image},totalPanjang(s){let e=this.form.data[s].variants.reduce((u,p)=>u+p.panjang*p.jumlah,0);return this.form.data[s].qty=e,e},getCustomers(s){axios.get(this.route("customer.data",{search:s})).then(e=>{this.customer=e.data})}}},l=s=>(ct("data-v-3f3e20d1"),s=s(),ut(),s),_t={key:0,class:"alert alert-success",role:"alert"},ht={key:1,class:"alert alert-danger",role:"alert"},ft={class:"card shadow mb-5"},gt={class:"card-body"},bt={id:"form-kasir"},vt={class:"table"},Pt=l(()=>t("thead",null,null,-1)),Vt={colspan:"5"},It={class:"form-group"},St=l(()=>t("label",{for:"customer",class:"form-label"},"Customer",-1)),xt={colspan:"5"},Ct={class:"col-md-12 row"},Dt={class:"col-xl-6 col-md-12"},jt={class:"card mb-3 shadow-lg"},wt={class:"row card-body"},Ut={class:"col-md-12"},yt={class:"text-right"},Ft=["onClick"],Tt={class:"col-md-12 text-center"},Kt=["src"],Mt={class:"form-group"},Rt=l(()=>t("label",{for:"product_id",class:"form-label"},"Produk",-1)),qt={class:"text-danger"},Nt={class:"form-group"},At=l(()=>t("label",{for:"unit_price",class:"form-label"},"Unit Price / 6m ",-1)),Bt={key:0},Ht={class:"input-group"},Et=l(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),Jt=["disabled","onUpdate:modelValue","onKeyup"],Lt={class:"text-danger"},zt={class:"p-2 mt-3 rounded",style:{background:"#f0f0f0"}},Ot=l(()=>t("label",{class:"form-label"},"Variants",-1)),Zt=["onClick"],Gt={class:"row"},Qt={class:"border p-2 rounded shadow bg-white"},Wt=["onClick"],Xt={class:"form-group"},Yt=l(()=>t("label",{class:"form-label"},"Panjang",-1)),kt=["onUpdate:modelValue","disabled"],$t={class:"form-group"},ts=l(()=>t("label",{class:"form-label"},"Jumlah",-1)),ss=["onUpdate:modelValue","disabled"],os={class:"form-group"},es=l(()=>t("label",{for:"jumlah",class:"form-label"},"Jumlah (Meter)",-1)),as={class:"input-group"},rs=["disabled","value"],ls=l(()=>t("div",{class:"input-group-append"},[t("span",{class:"input-group-text"},"Meter")],-1)),is={class:"text-danger"},ns={class:"row"},ds={class:"col-md-4"},cs={class:"form-group"},us=l(()=>t("label",{for:"discount_percentage",class:"form-label"},"Discount (%)",-1)),ps={class:"input-group"},ms=["disabled","onUpdate:modelValue","onKeyup"],_s=l(()=>t("div",{class:"input-group-append"},[t("span",{class:"input-group-text"},"%")],-1)),hs={class:"text-danger"},fs={class:"col-md-4"},gs={class:"form-group"},bs=l(()=>t("label",{for:"discount_price",class:"form-label"},"Discount (Rp)",-1)),vs={class:"input-group"},Ps=l(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),Vs=["disabled","onUpdate:modelValue","onKeyup"],Is={class:"text-danger"},Ss={class:"col-md-4"},xs={class:"form-group"},Cs=l(()=>t("label",{for:"total_price",class:"form-label"},"Total Price",-1)),Ds={class:"input-group"},js=l(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),ws=["value"],Us=["rowspan"],ys=l(()=>t("label",null,"Additional Fee",-1)),Fs=[ys],Ts={colspan:"2"},Ks={class:"form-group"},Ms={for:"additional_fee",class:"form-label"},Rs=["onUpdate:modelValue","disabled"],qs={class:"form-group"},Ns=l(()=>t("label",{for:"additional_fee",class:"form-label"},"Harga",-1)),As={class:"input-group"},Bs=l(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),Hs=["onUpdate:modelValue","disabled"],Es={class:"nt align-middle"},Js=["onClick"],Ls=l(()=>t("td",{colspan:"2"},"Discount",-1)),zs={class:"form-group"},Os={class:"input-group"},Zs=["disabled"],Gs=l(()=>t("div",{class:"input-group-append"},[t("span",{class:"input-group-text"},"%")],-1)),Qs={class:"form-group"},Ws={class:"input-group"},Xs=l(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),Ys=["disabled"],ks=l(()=>t("td",null,null,-1)),$s=l(()=>t("td",{colspan:"3"},"Total Transaksi",-1)),to={class:"form-group"},so={class:"input-group"},oo=l(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),eo=["value"],ao=l(()=>t("td",null,null,-1)),ro=l(()=>t("td",{colspan:"3"},"Kasir",-1)),lo={class:"form-group"},io=l(()=>t("td",null,null,-1)),no={class:"card shadow"},co=l(()=>t("div",{class:"card-header"},[t("h4",{class:"card-title"},[t("i",{class:"fa fa-box"}),pt("Â Data Penjualan Hari Ini ")])],-1));function uo(s,e,u,p,o,r){var F,T,K,M,R,q;const h=w("Head"),P=w("Multiselect"),D=w("Table"),b=dt("money");return d(),c("div",null,[C(h,{title:"Kasir"}),s.$page.props.flash.success?(d(),c("div",_t,_(s.$page.props.flash.success),1)):v("",!0),s.$page.props.flash.error?(d(),c("div",ht,_(s.$page.props.flash.error),1)):v("",!0),t("div",ft,[t("div",gt,[t("form",bt,[t("table",vt,[Pt,t("tbody",null,[t("tr",null,[t("td",Vt,[t("div",It,[St,C(P,{modelValue:o.form.customer,"onUpdate:modelValue":e[0]||(e[0]=n=>o.form.customer=n),options:o.customer,"track-by":"id",placeholder:"Pilih Customer",label:"name",onSearchChange:r.getCustomers,onSelect:r.addCustomer,"internal-search":!1,class:S({"is-invalid":(M=(K=(T=(F=s.$page)==null?void 0:F.props)==null?void 0:T.errors)==null?void 0:K.customer)==null?void 0:M.id})},null,8,["modelValue","options","onSearchChange","onSelect","class"])])])]),t("tr",null,[t("td",xt,[t("div",Ct,[(d(!0),c(U,null,y(o.form.data,(n,a)=>{var V,I,f,N,A,B,H,E,J,L,z,O,Z,G,Q,W,X,Y,k,tt,st,ot;return d(),c("div",Dt,[t("div",jt,[t("div",wt,[t("div",Ut,[t("div",null,[t("div",yt,[t("button",{type:"button",class:S(["btn btn-danger btn-sm",a==0?"disabled":""]),onClick:i=>r.removeProduct(a)},"Hapus",10,Ft)]),t("div",Tt,[t("img",{src:n.image??"https://img.freepik.com/premium-vector/default-image-icon-vector-missing-picture-page-website-design-mobile-app-no-photo-available_87543-11093.jpg",class:"card-img w-50 text-center",alt:"Image Preview"},null,8,Kt)]),t("div",Mt,[Rt,C(P,{modelValue:o.form.data[a].product,"onUpdate:modelValue":i=>o.form.data[a].product=i,options:o.products,"track-by":"id",placeholder:"Pilih Produk",label:"design_name",onSearchChange:r.getProducts,onSelect:i=>r.pilihData(a),onRemove:i=>r.resetFormByKey(a),"internal-search":!1,class:S({"is-invalid":(N=(f=(I=(V=s.$page)==null?void 0:V.props)==null?void 0:I.errors)==null?void 0:f.product)==null?void 0:N.id})},null,8,["modelValue","onUpdate:modelValue","options","onSearchChange","onSelect","onRemove","class"]),t("span",qt,_((E=(H=(B=(A=s.$page)==null?void 0:A.props)==null?void 0:B.errors)==null?void 0:H.product)==null?void 0:E.id),1)]),t("div",Nt,[At,o.form.data[a].product?(d(),c("span",Bt," ("+_(r.formatMoney(o.form.data[a].product.lowest_price))+" - "+_(r.formatMoney(o.form.data[a].product.highest_price))+") ",1)):v("",!0),t("div",Ht,[Et,m(t("input",{type:"text",class:"form-control",disabled:!o.form.data[a].product,"onUpdate:modelValue":i=>o.form.data[a].unit_price=i,onKeyup:i=>r.calcDisPrice(a)},null,40,Jt),[[b],[g,o.form.data[a].unit_price]])]),t("span",Lt,_((O=(z=(L=(J=s.$page)==null?void 0:J.props)==null?void 0:L.errors)==null?void 0:z.product)==null?void 0:O.id),1)]),t("div",zt,[Ot,t("button",{class:"btn btn-sm btn-primary mb-2",type:"button",onClick:i=>r.tambahVariants(a)},"+",8,Zt),t("div",Gt,[(d(!0),c(U,null,y(o.form.data[a].variants,(i,j)=>(d(),c("div",{class:"col-md-3 mb-2",key:j},[t("div",Qt,[t("button",{class:S(["btn btn-sm btn-danger float-right",{disabled:j==0}]),onClick:x=>r.removeVariant(a,j),type:"button"},"x",10,Wt),t("div",Xt,[Yt,m(t("input",{type:"number",class:"form-control","onUpdate:modelValue":x=>i.panjang=x,disabled:!o.form.data[a].product},null,8,kt),[[g,i.panjang]])]),t("div",$t,[ts,m(t("input",{type:"number",class:"form-control","onUpdate:modelValue":x=>i.jumlah=x,disabled:!o.form.data[a].product},null,8,ss),[[g,i.jumlah]])])])]))),128))])]),t("div",os,[es,t("div",as,[t("input",{type:"number",class:"form-control",disabled:!o.form.data[a].product,value:r.totalPanjang(a)},null,8,rs),ls]),t("span",is,_((W=(Q=(G=(Z=s.$page)==null?void 0:Z.props)==null?void 0:G.errors)==null?void 0:Q.product)==null?void 0:W.id),1)]),t("div",ns,[t("div",ds,[t("div",cs,[us,t("div",ps,[m(t("input",{type:"number",class:"form-control",disabled:!o.form.data[a].product,"onUpdate:modelValue":i=>o.form.data[a].discount_percentage=i,onKeyup:i=>r.calculateAll(a)},null,40,ms),[[g,o.form.data[a].discount_percentage]]),_s]),t("span",hs,_((k=(Y=(X=s.$page)==null?void 0:X.props)==null?void 0:Y.errors)==null?void 0:k.discount_percentage),1)])]),t("div",fs,[t("div",gs,[bs,t("div",vs,[Ps,m(t("input",{type:"text",class:"form-control",disabled:!o.form.data[a].product,"onUpdate:modelValue":i=>o.form.data[a].discount_price=i,onKeyup:i=>r.calcDisPerc(a)},null,40,Vs),[[b],[g,o.form.data[a].discount_price]])]),t("span",Is,_((ot=(st=(tt=s.$page)==null?void 0:tt.props)==null?void 0:st.errors)==null?void 0:ot.discount_price),1)])]),t("div",Ss,[t("div",xs,[Cs,t("div",Ds,[js,m(t("input",{type:"text",class:"form-control",value:r.totalUnitPrice(a),disabled:""},null,8,ws),[[b]])])])])])])])])])])}),256))]),t("button",{class:"btn btn-primary mb-2 col-md-12",type:"button",onClick:e[1]||(e[1]=(...n)=>r.tambahProduct&&r.tambahProduct(...n))}," + Tambah Product ")])]),(d(!0),c(U,null,y(o.form.additional,(n,a)=>{var V,I;return d(),c("tr",{key:a},[a==0?(d(),c("td",{key:0,rowspan:Object.keys(o.form.additional).length,class:"align-middle"},Fs,8,Us)):v("",!0),t("td",Ts,[t("div",Ks,[t("label",Ms," Additional Service "+_(a+1),1),m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":f=>o.form.additional[a].name=f,disabled:!((V=o.form.data[0])!=null&&V.product)},null,8,Rs),[[g,o.form.additional[a].name]])])]),t("td",null,[t("div",qs,[Ns,t("div",As,[Bs,m(t("input",{class:"form-control",type:"text","onUpdate:modelValue":f=>o.form.additional[a].total=f,disabled:!((I=o.form.data[0])!=null&&I.product),min:"0"},null,8,Hs),[[b],[g,o.form.additional[a].total]])])])]),t("td",Es,[a!=0?(d(),c("button",{key:0,class:"btn btn-danger btn-sm",onClick:f=>r.removeAdditional(a)}," x ",8,Js)):v("",!0),a==0?(d(),c("button",{key:1,class:"btn btn-primary btn-sm",type:"button",onClick:e[2]||(e[2]=(...f)=>r.tambahFee&&r.tambahFee(...f))}," + ")):v("",!0)])])}),128)),t("tr",null,[Ls,t("td",null,[t("div",zs,[t("div",Os,[m(t("input",{"onUpdate:modelValue":e[3]||(e[3]=n=>o.form.discount_percentage=n),class:"form-control",type:"number",onKeyup:e[4]||(e[4]=(...n)=>r.calcTotalDisPrice&&r.calcTotalDisPrice(...n)),disabled:!((R=o.form.data[0])!=null&&R.product)},null,40,Zs),[[g,o.form.discount_percentage]]),Gs])])]),t("td",null,[t("div",Qs,[t("div",Ws,[Xs,m(t("input",{"onUpdate:modelValue":e[5]||(e[5]=n=>o.form.discount=n),class:"form-control",type:"text",disabled:!((q=o.form.data[0])!=null&&q.product),onKeyup:e[6]||(e[6]=(...n)=>r.calcTotalDisPerc&&r.calcTotalDisPerc(...n))},null,40,Ys),[[b],[g,o.form.discount]])])])]),ks]),t("tr",null,[$s,t("td",null,[t("div",to,[t("div",so,[oo,m(t("input",{class:"form-control",type:"text",value:r.totalPrice,disabled:""},null,8,eo),[[b]])])])]),ao]),t("tr",null,[ro,t("td",null,[t("div",lo,[t("a",{class:S(["btn btn-primary float-right",{disabled:o.form.submit}]),onClick:e[7]||(e[7]=(...n)=>r.submitForm&&r.submitForm(...n))},"Submit",2)])]),io])])])])])]),t("div",no,[co,C(D,{columns:o.table,rows:u.data},null,8,["columns","rows"])])])}const fo=nt(mt,[["render",uo],["__scopeId","data-v-3f3e20d1"]]);export{fo as default};
