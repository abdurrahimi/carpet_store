import{A as nt}from"./AuthenticatedLayout-8HFN_jT3.js";import{M as it,a as dt}from"./vue-multiselect.esm-NEQ4FMqD.js";import{Z as ct,F as rt,_ as ut,r as j,H as pt,o as c,b as u,c as U,t as _,d as v,e as t,h as mt,n as S,f as D,m as x,i as m,v as h,l as _t,a as lt,p as ht,g as ft,I as gt}from"./app-CRmjEfMb.js";/* empty css                        */const bt={layout:nt,props:["data"],components:{Head:ct,Modal:it,Multiselect:dt},computed:{totalPrice(){var s,r;let o=0,e=0;(s=this.form.data)==null||s.map((f,P)=>{o+=parseInt(this.totalUnitPrice(P))??0}),(r=this.form.additional)==null||r.map((f,P)=>{let C=f.total.toString().replace(/\./g,"");e+=parseInt(C)});let d=this.form.discount??0;const p=parseInt(o)+parseInt(e)-parseInt(d.toString().replace(/\./g,""));return isNaN(p)?0:p}},data(){return{table:[{title:"Tanggal",data:"created_at"},{title:"Customer",data:"customer.name"},{title:"Jumlah",data:"final_price"}],modalTitle:"",modalShow:!1,selectedIds:[],form:{data:[{product:null,unit_top_price:0,qty:6,discount_price:0,discount_percentage:0,variants:[{panjang:6,jumlah:1}]}],customer:null,discount:0,discount_percentage:0,additional:[{name:"",total:0}],total:0,payment_method:0,shipping_method:"",attachment:[],submit:!1},products:[],variant:null,customer:[],store:[],preview:null,variants:[{panjang:0,jumlah:0}]}},mounted(){this.resetForm(),this.getProducts(),this.getCustomers()},methods:{async submitForm(){const o=new FormData;return o.append("data",JSON.stringify(this.form)),this.form.attachment.forEach(e=>{o.append("attachments[]",e)}),rt.post(this.route("order.create"),o,{preserveScroll:!0,onSuccess:()=>{this.form.submit=!1,$("#modal-add").modal("hide"),this.$success("Data berhasil disimpan"),rt.visit(this.$page.url,{only:["users"]})},onError:()=>{this.form.submit=!1,this.$error()}})},handleFileUpload(o){const e=o.target.files;this.form.attachment=[];for(let d=0;d<e.length;d++){const p=e[d];this.form.attachment.push(p)}},totalPriceBeforeDisc(){var d,p;let o=0,e=0;return(d=this.form.data)==null||d.map((s,r)=>{o+=parseInt(this.totalUnitPrice(r))??0}),(p=this.form.additional)==null||p.map((s,r)=>{let f=s.total.toString().replace(/\./g,"");e+=parseInt(f)}),console.log(o),parseInt(o)+parseInt(e)},totalUnitPrice(o){let e=this.form.data[o].unit_price||0,d=this.form.data[o].discount_price||0,p=parseInt(e.toString().replace(/\./g,""))||0,s=parseInt(this.form.data[o].qty)||0,r=parseInt(d.toString().replace(/\./g,""))||0,f=p*s/6-r;return isNaN(f)?0:f},calcDisPrice(o){if(this.form.data[o].discount_percentage==""||this.form.data[o].discount_percentage==null){this.form.data[o].discount_percentage=0;return}let e=this.form.data[o].unit_price.toString().replace(/\./g,"");this.form.data[o].discount_price=this.form.data[o].discount_percentage/100*(parseInt(e)*this.form.data[o].qty/6)},calcDisPerc(o){let e=this.form.data[o].discount_price.toString().replace(/\./g,""),d=this.form.data[o].unit_price.toString().replace(/\./g,"");this.form.data[o].discount_percentage=parseInt(e)/(parseInt(d)*this.form.data[o].qty/6)*100,this.form.data[o].discount_percentage=this.form.data[o].discount_percentage.toFixed(2)},calcTotalDisPrice(){if(this.form.discount_percentage==""||this.form.discount_percentage==null){this.form.discount_percentage=0;return}let o=this.totalPriceBeforeDisc();console.log(o),this.form.discount=this.form.discount_percentage/100*parseInt(o.toString().replace(/\./g,""))},calcTotalDisPerc(){let o=this.form.discount.toString().replace(/\./g,""),e=this.totalPriceBeforeDisc();this.form.discount_percentage=(parseInt(o)/parseInt(e.toString().replace(/\./g,""))*100).toFixed(2)},formatMoney(o){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(isNaN(o)?0:o)},tambahVariants(o){this.form.data[o].product&&this.form.data[o].variants.push({panjang:6,jumlah:1})},removeVariant(o,e){e!=0&&this.form.data[o].variants.splice(e,1)},calculateAll(o){this.calcDisPrice(o)},async getProducts(o=""){try{const{data:e}=await axios.get(this.route("products.get",{name:o}));this.products=e}catch(e){console.error("Error loading products",e)}},resetForm(){this.form={data:[{product:null,unit_top_price:0,qty:6,discount_price:0,discount_percentage:0,variants:[{panjang:6,jumlah:1}]}],customer:null,discount:0,discount_percentage:0,additional:[{name:"",total:0}],total:0,payment_method:0,submit:!1}},resetFormByKey(o){this.form.data[o]={product:null,unit_top_price:0,qty:6,discount_price:0,discount_percentage:0,variants:[{panjang:6,jumlah:1}]}},tambahProduct(){this.form.data.push({product:null,qty:6,unit_top_price:0,discount_price:0,discount_percentage:0,variants:[{panjang:6,jumlah:1}]})},tambahFee(){this.form.additional.push({name:"",total:0})},removeAdditional(o){o!=0&&this.form.additional.splice(o,1)},removeProduct(o){o!=0&&this.form.data.splice(o,1)},addCustomer(){console.log("okok")},pilihData(o){const e=this.form.data[o].product;this.form.data[o].unit_price=e.lowest_price??0,this.form.data[o].image=e.image},totalPanjang(o){let e=this.form.data[o].variants.reduce((d,p)=>d+p.panjang*p.jumlah,0);return this.form.data[o].qty=e,e},getCustomers(o){axios.get(this.route("customer.data",{search:o})).then(e=>{this.customer=e.data})}}},l=o=>(ht("data-v-f33ff819"),o=o(),ft(),o),vt={key:0,class:"alert alert-success",role:"alert"},Pt={key:1,class:"alert alert-danger",role:"alert"},Vt={class:"card shadow mb-5"},yt={class:"card-body"},St={class:"table"},It=l(()=>t("thead",null,null,-1)),Ut={colspan:"5"},Dt={class:"form-group"},xt=l(()=>t("label",{for:"customer",class:"form-label"},"Customer",-1)),Ct={colspan:"5"},wt={class:"col-md-12 row"},jt={class:"col-xl-6 col-md-12"},Ft={class:"card mb-3 shadow-lg"},Tt={class:"row card-body"},Kt={class:"col-md-12"},Mt={class:"text-right"},Nt=["onClick"],Rt={class:"col-md-12 text-center"},qt=["src"],At={class:"form-group"},Bt=l(()=>t("label",{for:"product_id",class:"form-label"},"Produk",-1)),Ht={class:"text-danger"},Et={class:"form-group"},Jt=l(()=>t("label",{for:"unit_price",class:"form-label"},"Unit Price / 6m ",-1)),Lt={key:0},Ot={class:"input-group"},zt=l(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),Zt=["disabled","onUpdate:modelValue","onKeyup"],Gt={class:"text-danger"},Qt={class:"p-2 mt-3 rounded",style:{background:"#f0f0f0"}},Wt=l(()=>t("label",{class:"form-label"},"Variants",-1)),Xt=["onClick"],Yt={class:"row"},kt={class:"border p-2 rounded shadow bg-white"},$t=["onClick"],to={class:"form-group"},oo=l(()=>t("label",{class:"form-label"},"Panjang",-1)),eo=["onUpdate:modelValue","disabled"],so={class:"form-group"},ao=l(()=>t("label",{class:"form-label"},"Jumlah",-1)),ro=["onUpdate:modelValue","disabled"],lo={class:"form-group"},no=l(()=>t("label",{for:"jumlah",class:"form-label"},"Jumlah (Meter)",-1)),io={class:"input-group"},co=["disabled","value"],uo=l(()=>t("div",{class:"input-group-append"},[t("span",{class:"input-group-text"},"Meter")],-1)),po={class:"text-danger"},mo={class:"row"},_o={class:"col-md-4"},ho={class:"form-group"},fo=l(()=>t("label",{for:"discount_percentage",class:"form-label"},"Discount (%)",-1)),go={class:"input-group"},bo=["disabled","onUpdate:modelValue","onKeyup"],vo=l(()=>t("div",{class:"input-group-append"},[t("span",{class:"input-group-text"},"%")],-1)),Po={class:"text-danger"},Vo={class:"col-md-4"},yo={class:"form-group"},So=l(()=>t("label",{for:"discount_price",class:"form-label"},"Discount (Rp)",-1)),Io={class:"input-group"},Uo=l(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),Do=["disabled","onUpdate:modelValue","onKeyup"],xo={class:"text-danger"},Co={class:"col-md-4"},wo={class:"form-group"},jo=l(()=>t("label",{for:"total_price",class:"form-label"},"Total Price",-1)),Fo={class:"input-group"},To=l(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),Ko=["value"],Mo=["rowspan"],No=l(()=>t("label",null,"Additional Fee",-1)),Ro=[No],qo={colspan:"2"},Ao={class:"form-group"},Bo={for:"additional_fee",class:"form-label"},Ho=["onUpdate:modelValue","disabled"],Eo={class:"form-group"},Jo=l(()=>t("label",{for:"additional_fee",class:"form-label"},"Harga",-1)),Lo={class:"input-group"},Oo=l(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),zo=["onUpdate:modelValue","disabled"],Zo={class:"nt align-middle"},Go=["onClick"],Qo=l(()=>t("td",{colspan:"2"},"Discount",-1)),Wo={class:"form-group"},Xo={class:"input-group"},Yo=["disabled"],ko=l(()=>t("div",{class:"input-group-append"},[t("span",{class:"input-group-text"},"%")],-1)),$o={class:"form-group"},te={class:"input-group"},oe=l(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),ee=["disabled"],se=l(()=>t("td",null,null,-1)),ae=l(()=>t("td",{colspan:"3"},"Total Transaksi",-1)),re={class:"form-group"},le={class:"input-group"},ne=l(()=>t("div",{class:"input-group-prepend"},[t("span",{class:"input-group-text"},"Rp")],-1)),ie=["value"],de=l(()=>t("td",null,null,-1)),ce=l(()=>t("td",{colspan:"3"},"Metode Pembayaran",-1)),ue={class:"form-group"},pe=gt('<option value="0" data-v-f33ff819>Tunai</option><option value="1" data-v-f33ff819>AR</option><option value="2" data-v-f33ff819>Transfer</option><option value="3" data-v-f33ff819>Kartu Kredit</option><option value="4" data-v-f33ff819>Lainnya</option>',5),me=[pe],_e=l(()=>t("td",null,null,-1)),he=l(()=>t("td",{colspan:"3"},"Metode Pengiriman",-1)),fe={class:"form-group"},ge=["disabled"],be=l(()=>t("td",null,null,-1)),ve=l(()=>t("td",{colspan:"3"},"Lampiran",-1)),Pe={class:"form-group"},Ve=["disabled"],ye={class:"mt-2 border p-2 bg-dark-200"},Se=l(()=>t("b",null,"*",-1)),Ie=l(()=>t("td",null,null,-1)),Ue=l(()=>t("td",{colspan:"3"},"Kasir",-1)),De={class:"form-group"},xe=l(()=>t("td",null,null,-1)),Ce={class:"card shadow"},we=l(()=>t("div",{class:"card-header"},[t("h4",{class:"card-title"},[t("i",{class:"fa fa-box"}),lt("Â Data Penjualan Hari Ini ")])],-1));function je(o,e,d,p,s,r){var F,T,K,M,N,R,q,A;const f=j("Head"),P=j("Multiselect"),C=j("Table"),b=pt("money");return c(),u("div",null,[U(f,{title:"Kasir"}),o.$page.props.flash.success?(c(),u("div",vt,_(o.$page.props.flash.success),1)):v("",!0),o.$page.props.flash.error?(c(),u("div",Pt,_(o.$page.props.flash.error),1)):v("",!0),t("div",Vt,[t("div",yt,[t("form",{id:"form-kasir",enctype:"multipart/form-data",onSubmit:e[11]||(e[11]=mt((...n)=>r.submitForm&&r.submitForm(...n),["prevent"]))},[t("table",St,[It,t("tbody",null,[t("tr",null,[t("td",Ut,[t("div",Dt,[xt,U(P,{modelValue:s.form.customer,"onUpdate:modelValue":e[0]||(e[0]=n=>s.form.customer=n),options:s.customer,"track-by":"id",placeholder:"Pilih Customer",label:"name",onSearchChange:r.getCustomers,onSelect:r.addCustomer,"internal-search":!1,class:S({"is-invalid":(M=(K=(T=(F=o.$page)==null?void 0:F.props)==null?void 0:T.errors)==null?void 0:K.customer)==null?void 0:M.id})},null,8,["modelValue","options","onSearchChange","onSelect","class"])])])]),t("tr",null,[t("td",Ct,[t("div",wt,[(c(!0),u(D,null,x(s.form.data,(n,a)=>{var V,y,g,B,H,E,J,L,O,z,Z,G,Q,W,X,Y,k,tt,ot,et,st,at;return c(),u("div",jt,[t("div",Ft,[t("div",Tt,[t("div",Kt,[t("div",null,[t("div",Mt,[t("button",{type:"button",class:S(["btn btn-danger btn-sm",a==0?"disabled":""]),onClick:i=>r.removeProduct(a)},"Hapus",10,Nt)]),t("div",Rt,[t("img",{src:n.image??"https://img.freepik.com/premium-vector/default-image-icon-vector-missing-picture-page-website-design-mobile-app-no-photo-available_87543-11093.jpg",class:"card-img w-50 text-center",alt:"Image Preview"},null,8,qt)]),t("div",At,[Bt,U(P,{modelValue:s.form.data[a].product,"onUpdate:modelValue":i=>s.form.data[a].product=i,options:s.products,"track-by":"id",placeholder:"Pilih Produk",label:"design_name",onSearchChange:r.getProducts,onSelect:i=>r.pilihData(a),onRemove:i=>r.resetFormByKey(a),"internal-search":!1,class:S({"is-invalid":(B=(g=(y=(V=o.$page)==null?void 0:V.props)==null?void 0:y.errors)==null?void 0:g.product)==null?void 0:B.id})},null,8,["modelValue","onUpdate:modelValue","options","onSearchChange","onSelect","onRemove","class"]),t("span",Ht,_((L=(J=(E=(H=o.$page)==null?void 0:H.props)==null?void 0:E.errors)==null?void 0:J.product)==null?void 0:L.id),1)]),t("div",Et,[Jt,s.form.data[a].product?(c(),u("span",Lt," ("+_(r.formatMoney(s.form.data[a].product.lowest_price))+" - "+_(r.formatMoney(s.form.data[a].product.highest_price))+") ",1)):v("",!0),t("div",Ot,[zt,m(t("input",{type:"text",class:"form-control",disabled:!s.form.data[a].product,"onUpdate:modelValue":i=>s.form.data[a].unit_price=i,onKeyup:i=>r.calcDisPrice(a)},null,40,Zt),[[b],[h,s.form.data[a].unit_price]])]),t("span",Gt,_((G=(Z=(z=(O=o.$page)==null?void 0:O.props)==null?void 0:z.errors)==null?void 0:Z.product)==null?void 0:G.id),1)]),t("div",Qt,[Wt,t("button",{class:"btn btn-sm btn-primary mb-2",type:"button",onClick:i=>r.tambahVariants(a)},"+",8,Xt),t("div",Yt,[(c(!0),u(D,null,x(s.form.data[a].variants,(i,w)=>(c(),u("div",{class:"col-md-3 mb-2",key:w},[t("div",kt,[t("button",{class:S(["btn btn-sm btn-danger float-right",{disabled:w==0}]),onClick:I=>r.removeVariant(a,w),type:"button"},"x",10,$t),t("div",to,[oo,m(t("input",{type:"number",class:"form-control","onUpdate:modelValue":I=>i.panjang=I,disabled:!s.form.data[a].product},null,8,eo),[[h,i.panjang]])]),t("div",so,[ao,m(t("input",{type:"number",class:"form-control","onUpdate:modelValue":I=>i.jumlah=I,disabled:!s.form.data[a].product},null,8,ro),[[h,i.jumlah]])])])]))),128))])]),t("div",lo,[no,t("div",io,[t("input",{type:"number",class:"form-control",disabled:!s.form.data[a].product,value:r.totalPanjang(a)},null,8,co),uo]),t("span",po,_((Y=(X=(W=(Q=o.$page)==null?void 0:Q.props)==null?void 0:W.errors)==null?void 0:X.product)==null?void 0:Y.id),1)]),t("div",mo,[t("div",_o,[t("div",ho,[fo,t("div",go,[m(t("input",{type:"number",class:"form-control",disabled:!s.form.data[a].product,"onUpdate:modelValue":i=>s.form.data[a].discount_percentage=i,onKeyup:i=>r.calculateAll(a)},null,40,bo),[[h,s.form.data[a].discount_percentage]]),vo]),t("span",Po,_((ot=(tt=(k=o.$page)==null?void 0:k.props)==null?void 0:tt.errors)==null?void 0:ot.discount_percentage),1)])]),t("div",Vo,[t("div",yo,[So,t("div",Io,[Uo,m(t("input",{type:"text",class:"form-control",disabled:!s.form.data[a].product,"onUpdate:modelValue":i=>s.form.data[a].discount_price=i,onKeyup:i=>r.calcDisPerc(a)},null,40,Do),[[b],[h,s.form.data[a].discount_price]])]),t("span",xo,_((at=(st=(et=o.$page)==null?void 0:et.props)==null?void 0:st.errors)==null?void 0:at.discount_price),1)])]),t("div",Co,[t("div",wo,[jo,t("div",Fo,[To,m(t("input",{type:"text",class:"form-control",value:r.totalUnitPrice(a),disabled:""},null,8,Ko),[[b]])])])])])])])])])])}),256))]),t("button",{class:"btn btn-primary mb-2 col-md-12",type:"button",onClick:e[1]||(e[1]=(...n)=>r.tambahProduct&&r.tambahProduct(...n))}," + Tambah Product ")])]),(c(!0),u(D,null,x(s.form.additional,(n,a)=>{var V,y;return c(),u("tr",{key:a},[a==0?(c(),u("td",{key:0,rowspan:Object.keys(s.form.additional).length,class:"align-middle"},Ro,8,Mo)):v("",!0),t("td",qo,[t("div",Ao,[t("label",Bo," Additional Service "+_(a+1),1),m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":g=>s.form.additional[a].name=g,disabled:!((V=s.form.data[0])!=null&&V.product)},null,8,Ho),[[h,s.form.additional[a].name]])])]),t("td",null,[t("div",Eo,[Jo,t("div",Lo,[Oo,m(t("input",{class:"form-control",type:"text","onUpdate:modelValue":g=>s.form.additional[a].total=g,disabled:!((y=s.form.data[0])!=null&&y.product),min:"0"},null,8,zo),[[b],[h,s.form.additional[a].total]])])])]),t("td",Zo,[a!=0?(c(),u("button",{key:0,class:"btn btn-danger btn-sm",onClick:g=>r.removeAdditional(a)}," x ",8,Go)):v("",!0),a==0?(c(),u("button",{key:1,class:"btn btn-primary btn-sm",type:"button",onClick:e[2]||(e[2]=(...g)=>r.tambahFee&&r.tambahFee(...g))}," + ")):v("",!0)])])}),128)),t("tr",null,[Qo,t("td",null,[t("div",Wo,[t("div",Xo,[m(t("input",{"onUpdate:modelValue":e[3]||(e[3]=n=>s.form.discount_percentage=n),class:"form-control",type:"number",onKeyup:e[4]||(e[4]=(...n)=>r.calcTotalDisPrice&&r.calcTotalDisPrice(...n)),disabled:!((N=s.form.data[0])!=null&&N.product)},null,40,Yo),[[h,s.form.discount_percentage]]),ko])])]),t("td",null,[t("div",$o,[t("div",te,[oe,m(t("input",{"onUpdate:modelValue":e[5]||(e[5]=n=>s.form.discount=n),class:"form-control",type:"text",disabled:!((R=s.form.data[0])!=null&&R.product),onKeyup:e[6]||(e[6]=(...n)=>r.calcTotalDisPerc&&r.calcTotalDisPerc(...n))},null,40,ee),[[b],[h,s.form.discount]])])])]),se]),t("tr",null,[ae,t("td",null,[t("div",re,[t("div",le,[ne,m(t("input",{class:"form-control",type:"text",value:r.totalPrice,disabled:""},null,8,ie),[[b]])])])]),de]),t("tr",null,[ce,t("td",null,[t("div",ue,[m(t("select",{class:"form-control","onUpdate:modelValue":e[7]||(e[7]=n=>s.form.payment_method=n)},me,512),[[_t,s.form.payment_method]])])]),_e]),t("tr",null,[he,t("td",null,[t("div",fe,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[8]||(e[8]=n=>s.form.shipping_method=n),disabled:!((q=s.form.data[0])!=null&&q.product)},null,8,ge),[[h,s.form.shipping_method]])])]),be]),t("tr",null,[ve,t("td",null,[t("div",Pe,[t("input",{type:"file",class:"form-control",accept:".pdf,image/*",multiple:"",onChange:e[9]||(e[9]=(...n)=>r.handleFileUpload&&r.handleFileUpload(...n)),disabled:((A=s.form.data[0])!=null&&A.product,!1)},null,40,Ve),t("ul",ye,[(c(!0),u(D,null,x(s.form.attachment,(n,a)=>(c(),u("li",{key:a},[Se,lt(" "+_(n.name),1)]))),128))])])]),Ie]),t("tr",null,[Ue,t("td",null,[t("div",De,[t("a",{class:S(["btn btn-primary float-right",{disabled:s.form.submit}]),onClick:e[10]||(e[10]=(...n)=>r.submitForm&&r.submitForm(...n))},"Submit",2)])]),xe])])])],32)])]),t("div",Ce,[we,U(C,{columns:s.table,rows:d.data},null,8,["columns","rows"])])])}const Ne=ut(bt,[["render",je],["__scopeId","data-v-f33ff819"]]);export{Ne as default};
